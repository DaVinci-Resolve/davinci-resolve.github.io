"use strict";var bmdApp=angular.module("bmdApp",["ngAnimate","bmdControllers","bmdServices","bmdFilters","bmdDirectives","ui.router","pasvaz.bindonce"]);bmdApp.config(["$locationProvider",function(e){e.html5Mode(!0).hashPrefix("!")}]),bmdApp.factory("bmdLocation",function(){return function(e,t){var n=e.$$rewrite?"$$rewrite":"$$parseLinkUrl";return e.__origMethod=e[n],e[n]=function(n,r){if(void 0!==t){var i=n.match("^(/.+)?/(?:"+t+")")||n.match(window.location.origin+"(/.+)?/"+t);return i?e.__origMethod(n,r):void 0}},e}});var bmdServices=angular.module("bmdServices",["ngResource"]);bmdServices.factory("i18n",["$window",function(e){var t=e.__bmd||{},n={getCountry:function(){return t.getCountry?t.getCountry():"us"},getIsoCountry:function(){return t.getIsoCountry?t.getIsoCountry():"us"},getLang:function(){return t.getLang?t.getLang():"en"},getUrlPrefix:function(){return t.getUrlPrefix?t.getUrlPrefix():""},getUnicodeLocale:function(){return t.getUnicodeLocale?t.getUnicodeLocale():"en_US"},hasStore:function(){return!!t.hasStore&&t.hasStore()}};return n}]),bmdServices.factory("SimpleModalService",["$compile","$window",function(e,t){var n={create:function(t,n,r,i,o){o=o||"body",i=i||{};var c=r.$new(!1);for(var u in i)c[u]=i[u];var a="modal-"+Math.random().toString(16).substring(8),l=document.createElement("div");l.setAttribute("id",a),l.setAttribute("ng-include","'"+t+"'"),l.setAttribute("class",n);var s=e(l),d=s(c);return{scope:c,container:d,open:function(){$(o).append(d)},close:function(){c.$destroy();var e="#"+a;$(e).remove()}}}};return n}]),bmdServices.factory("ModalService",["$rootScope","$compile","$window","$animate",function(e,t,n,r){var i={create:function(n,i,o){var c=document.createElement("div");c.setAttribute("ng-include","'"+n+"'"),c.setAttribute("class",i);var u={};u.containerSelector="."+i,u.target=o||"body",u.scope=e.$new();var a=t(c);return u.element=a(u.scope),u.addToView=function(){$(this.target).append(this.element)},u.destroy=function(){r.leave($(this.containerSelector),function(){this.scope.$destroy()}.bind(this))},u}};return i}]),bmdServices.factory("PathService",function(){var e={extractParamsFromPath:function(e,t){for(var n=e.split("/"),r=t.split("/"),i={},o=0;o<n.length;o++)":"===n[o].charAt(0)&&(i[n[o].substr(1)]="undefined"!=typeof r[o]?r[o]:null);return i},extractPathFromUrl:function(e){var t=document.createElement("a");return t.href=e,t.pathname}};return e}),bmdServices.factory("RetinaService",function(){var e={isRetinaDevice:function(){if(window.devicePixelRatio>1)return!0;if(window.matchMedia){var e=["only screen and (-webkit-min-device-pixel-ratio: 2)","only screen and (min-resolution: 2dppx)","only screen and (min-resolution: 192dpi)"].join(",");return window.matchMedia(e).matches}return!1},getRetinaImgPath:function(t){return!e.isRetinaDevice()||/@2x\.\w+$/.test(t)?t:t.replace(/\.\w+$/,function(e){return"@2x"+e})}};return e});var bmdControllers=angular.module("bmdControllers",[]);bmdControllers.controller("PageCtrl",["$scope","$rootScope","$window","$location","i18n","SimpleModalService","$transitions",function(e,t,n,r,i,o,c){e.i18n={country:i.getCountry(),isoCountry:i.getIsoCountry(),lang:i.getLang(),prefix:i.getUrlPrefix(),hasStore:i.hasStore()};var u={opened:!1,current:null};e.mailto=function(e){if(e.includes("@"))return"mailto:"},e.openSimpleModal=function(t,n,r,i){null==u.current&&(i=i||e,u.opened=!0,u.current=o.create(t,n,i,r),u.current.open(),$("html").css("overflow","hidden"))},e.closeSimpleModal=function(){null!=u.current&&(u.opened=!1,u.current.close(),u.current=null),$("html").css("overflow","")},c.onStart({},function(t){e.closeSimpleModal()}),e.buyNowClickHandler=function(e){n.location.href=e}}]),bmdControllers.controller("RedirectCtrl",["$location","$window",function(e,t){t.location.href=e.url()}]);var bmdDirectives=angular.module("bmdDirectives",[]);bmdDirectives.directive("countryLink",["$state","$window",function(e,t){return{restrict:"A",scope:{lang:"="},link:function(e,n,r){var i=r.currentCountry,o=r.countryLink,c="us"==i?null:"/"+i,u="us"==o?null:"/"+o;n.click(function(e){var n=t.location.pathname;null!=n&&(e.stopPropagation(),e.preventDefault(),null!=c&&(n=n.replace(new RegExp("^"+c,"i"),"")),null!=u&&(n=u+n),t.location.href=n)})}}}]);var bmdFilters=angular.module("bmdFilters",[]);bmdFilters.filter("unsafe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),bmdFilters.filter("xlate",["$window",function(e){return function(t){var n=e.__bmd&&e.__bmd.catalogues||{};for(var r in n){var i=n[r]||{},o=i[t];if(void 0!==o)return o}return t}}]),bmdFilters.filter("capitalize",function(){return function(e){var t=e.toLowerCase();return t.substring(0,1).toUpperCase()+t.substring(1)}}),bmdFilters.filter("domain",[function(){return function(e){var t=e.match(/^(https?):\/\/([^\/?#]+)(?:[\/?#]|$)/i);return t?t[2]:e}}]),bmdFilters.filter("truncate",[function(){return function(e,t){return e.length-3>t?e.substr(0,t)+"...":e}}]),bmdFilters.filter("retina",function(){return function(e){return/@2x\.(png|jpg|jpeg|gif)$/.test(e)?e:e.replace(/\.\w+(\?.(png|jpg|jpeg|gif))?$/,function(e){return"@2x"+e})}}),bmdDirectives.directive("modalResize",["$window",function(e){return function(t,n,r){var i=r.minHeight||740,o=$(e);t.getWindowData=function(){return{winHeight:o.height()}},t.$watch(t.getWindowData,function(e,n){if(e.winHeight<i){var r=e.winHeight-20,o=-r/2;t.modalResizeStyle=function(){return{"margin-top":o+"px"}};var c=Math.max(e.winHeight-200,50);t.modalContentResizeStyle=function(){return{"max-height":c+"px",overflow:"auto"}}}else t.modalResizeStyle=function(){return{}},t.modalContentResizeStyle=function(){return{}}},!0),o.bind("resize",function(){t.$apply()})}}]),bmdDirectives.directive("videoLink",[function(){return{restrict:"A",scope:!0,link:function(e,t,n){t.off("click"),t.click(function(e){e.preventDefault(),launchVideo($(this))})}}}]);